<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Product Detail â€” MiawShoes</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
<style>
  :root{
    --brown-1:#8b5e3c;
    --brown-2:#d6a56b;
    --bg:#fffaf3;
    --card:#fff9ed;
    --accent:#b8860b;
    --text:#4a3b2d;
  }
  *{box-sizing:border-box}
  body{font-family:'Poppins',sans-serif;background:var(--bg);color:var(--text);margin:0;padding:0;}
  .navbar{background:rgba(255,255,255,0.92);backdrop-filter:blur(6px);box-shadow:0 4px 18px rgba(0,0,0,0.06);}
  .back-btn{background:linear-gradient(45deg,var(--brown-2),var(--brown-1));color:#fff;padding:8px 20px;border-radius:30px;text-decoration:none;}
  .product-section{max-width:1200px;margin:110px auto;padding:30px;}
  .product-images img{width:100%;height:520px;object-fit:cover;border-radius:18px;box-shadow:0 10px 30px rgba(0,0,0,0.08);}
  .thumbnail-list{display:flex;gap:10px;margin-top:12px;}
  .thumbnail-list img{width:76px;height:76px;object-fit:cover;border-radius:10px;cursor:pointer;border:2px solid transparent;}
  .thumbnail-list img.active{border-color:var(--accent);}
  .product-name{font-size:2.4rem;font-weight:800;color:var(--accent);margin-bottom:6px;}
  .product-price{font-size:1.8rem;font-weight:800;color:var(--brown-2);margin-bottom:14px;}
  .product-description{background:var(--card);padding:14px;border-radius:12px;margin-bottom:18px;line-height:1.6;}
  .quantity-control{display:flex;align-items:center;gap:8px;margin-bottom:18px;}
  .quantity-control button{width:42px;height:42px;border-radius:8px;border:none;background:var(--accent);color:#fff;font-weight:700;cursor:pointer;}
  .quantity-control input{width:80px;text-align:center;border-radius:8px;border:1px solid #ddd;padding:8px;}
  .btn-cart,.btn-buy{padding:12px 22px;border-radius:14px;font-weight:700;text-decoration:none;display:inline-block;}
  .btn-cart{background:#d2b48c;color:#fff;}
  .btn-buy{background:linear-gradient(45deg,#ffd700,#b8860b);color:#fff;border-radius:22px;}
  .seller-box{display:flex;align-items:center;gap:16px;padding:14px;background:var(--card);border-radius:12px;}
  .seller-logo{width:70px;height:70px;border-radius:50%;object-fit:cover;border:3px solid rgba(0,0,0,0.04);}
  .star{color:#f5b50a;margin-right:6px;}
  .review-box{background:#fff;border-radius:12px;padding:12px;margin-bottom:10px;box-shadow:0 4px 12px rgba(0,0,0,0.03);}
  /* mini cart */
  #cart-container{position:fixed;top:24px;right:18px;z-index:1200;display:flex;flex-direction:column;align-items:flex-end;gap:10px}
  #cart-icon{cursor:pointer;position:relative;display:inline-flex;align-items:center;justify-content:center;padding:10px;background:#fff;border-radius:12px;box-shadow:0 6px 20px rgba(0,0,0,0.12);width:54px;height:54px}
  #cart-count{position:absolute;top:-8px;right:-8px;background:var(--brown-2);color:#fff;border-radius:50%;padding:4px 8px;font-weight:800;font-size:0.85rem;}
  #cart-popup{width:380px;max-height:520px;background:#fffaf0;border-radius:15px;box-shadow:0 18px 40px rgba(0,0,0,0.2);padding:14px;overflow:auto;transform:translateX(20px);opacity:0;pointer-events:none;transition:all .18s ease;}
  #cart-popup.visible{transform:translateX(0);opacity:1;pointer-events:auto;}
  .cart-item{display:flex;gap:10px;align-items:center;padding:8px;border-radius:10px;background:#fff9ee;margin-bottom:10px;}
  .cart-item img{width:64px;height:64px;object-fit:cover;border-radius:8px;}
  .cart-item .meta{flex:1;}
  .cart-item .meta .name{font-weight:700}
  .cart-item .meta .small{font-size:0.85rem;color:#666}
  .cart-controls{display:flex;align-items:center;gap:6px;margin-top:8px}
  .cart-controls button{width:30px;height:30px;border-radius:6px;border:none;background:var(--accent);color:#fff;font-weight:700;cursor:pointer}
  .cart-controls select{padding:6px;border-radius:6px;border:1px solid #ddd}
  .cart-footer{text-align:center;margin-top:8px;}
  .cart-footer .btn-buy{padding:10px 18px;font-size:0.95rem;}
  @media(max-width:991px){ .product-images img{height:400px;} .thumbnail-list img{width:54px;height:54px;} #cart-popup{right:10px;width:92vw;} .product-section{padding:16px;margin-top:90px;} }
</style>
</head>
<body>

<nav class="navbar navbar-expand-lg fixed-top py-3">
  <div class="container d-flex align-items-center">
    <a href="collection.html" class="back-btn">â¬… Back</a>
    <a class="navbar-brand ms-3 fw-bold" href="index.html" style="color:var(--brown-1);text-decoration:none">MiawShoes ðŸ‘Ÿ</a>
    <div class="ms-auto">
      <span class="text-muted small">Shop â€¢ Elegant â€¢ Cozy</span>
    </div>
  </div>
</nav>

<!-- Mini Cart (pojok kanan atas) -->
<div id="cart-container">
  <div id="cart-icon" title="Keranjang">
    <i class="fas fa-shopping-cart fa-lg"></i>
    <div id="cart-count">0</div>
  </div>
  <div id="cart-popup" aria-live="polite">
    <h6 style="text-align:center;color:var(--accent);font-weight:800;margin-bottom:8px;">Keranjangmu ðŸ›’</h6>
    <div id="cart-items" style="min-height:60px;"></div>
    <div style="border-top:1px dashed #eee;padding-top:10px;">
      <div style="display:flex;justify-content:space-between;font-weight:700;margin-bottom:8px;">
        <div>Total</div>
        <div id="cart-popup-total">Rp 0</div>
      </div>
      <div class="cart-footer">
        <a id="popup-checkout" href="checkout.html" class="btn-buy">Lanjut ke Checkout</a>
      </div>
    </div>
  </div>
</div>


<section class="product-section container">
  <div id="product-detail" class="row g-4 align-items-start"></div>
</section>

<script>
  
/* ---------------- DATA PRODUK (9 produk) ---------------- */
const products = {
  "catstep-classic": {
    id:"catstep-classic",
    name:"CatStep Classic",
    price:499000,
    images:["assets/img/shoe1.jpg","assets/img/shoe1-2.jpg","assets/img/shoe1-3.jpg"],
    description:"Ringan, fleksibel, dan nyaman untuk langkah santaimu.",
    fullDescription:"CatStep Classic dirancang untuk kamu yang menginginkan kenyamanan dan gaya dalam satu langkah. Sol empuk, bahan breathable, dan tampilan minimalis cocok untuk keseharian.",
    rating:4.8,
    reviews:[
      {user:"Tomo", rating:5, text:"Awalnya cuma iseng beli, tapi ternyata super nyaman!"},
      {user:"Otsuka", rating:5, text:"Modelnya simpel tapi elegan. Cocok buat daily outfit."}
    ],
    seller:{name:"MiawShoes Official", logo:"assets/img/seller.jpg"}
  },
  "pawlite-runner": { id:"pawlite-runner", name:"PawLite Runner", price:599000, images:["assets/img/shoe2.jpg","assets/img/shoe2-2.jpg","assets/img/shoe2-3.jpg"], description:"Sepatu lari ringan, responsif untuk aktivitas sehari-hari.", fullDescription:"PawLite Runner dibuat untuk kamu yang aktif. Sol responsif dan material breathable membantu langkahmu tetap ringan dan nyaman.", rating:4.6, reviews:[{user:"Riko", rating:4, text:"Bagus tapi agak sempit di jari kaki."},{user:"Sakura", rating:5, text:"Super nyaman untuk jogging pagi."}], seller:{name:"MiawShoes Official", logo:"assets/img/seller.jpg"} },
  "whisker-walk": { id:"whisker-walk", name:"Whisker Walk", price:699000, images:["assets/img/shoe3.jpg","assets/img/shoe3-2.jpg","assets/img/shoe3-3.jpg"], description:"Klasik & stylish, untuk penampilan lebih percaya diri.", fullDescription:"Whisker Walk menggabungkan gaya klasik dan material modern, cocok untuk tampilan kasual hingga semi-formal.", rating:4.7, reviews:[{user:"Mila", rating:5, text:"Nyaman dan stylish! Banyak pujian."},{user:"Ken", rating:4, text:"Worth it untuk quality-nya."}], seller:{name:"MiawShoes Boutique", logo:"assets/img/seller.jpg"} },
  "feline-flex": { id:"feline-flex", name:"Feline Flex", price:749000, images:["assets/img/shoe4.jpg","assets/img/shoe4-2.jpg","assets/img/shoe4-3.jpg"], description:"Fleksibel dan ergonomis untuk mobilitas maksimal.", fullDescription:"Feline Flex diproduksi dengan material lentur yang mendukung gerakan alami kaki, ideal untuk yang aktif setiap hari.", rating:4.5, reviews:[{user:"Nana", rating:5, text:"Ringan dan enak dipakai seharian."},{user:"Dwi", rating:4, text:"Cocok untuk kerja dan jalan santai."}], seller:{name:"MiawShoes Official", logo:"assets/img/seller.jpg"} },
  "purrfect-step": { id:"purrfect-step", name:"Purrfect Step", price:799000, images:["assets/img/shoe5.jpg","assets/img/shoe5-2.jpg","assets/img/shoe5-3.jpg"], description:"Elegan, cocok untuk fashion statement.", fullDescription:"Purrfect Step menggunakan material premium dan desain eksklusif agar tampil beda pada setiap kesempatan spesialmu.", rating:5.0, reviews:[{user:"Mila", rating:5, text:"Luxury banget! Teman-teman pada tanya beli di mana."},{user:"Ken", rating:5, text:"Worth it untuk harga segitu, nyaman dan stylish."}], seller:{name:"MiawShoes Luxe", logo:"assets/img/seller.jpg"} },
  "catwalk-pro": { id:"catwalk-pro", name:"CatWalk Pro", price:899000, images:["assets/img/shoe6.jpg","assets/img/shoe6-2.jpg","assets/img/shoe6-3.jpg"], description:"Premium performance dengan sentuhan modern.", fullDescription:"CatWalk Pro dirancang untuk performa â€” sol kuat dan desain aerodinamis memberikan kenyamanan saat beraktivitas intens.", rating:4.9, reviews:[{user:"Aris", rating:5, text:"Mantap buat dipakai aktivitas berat."},{user:"Siti", rating:5, text:"Materialnya oke dan awet."}], seller:{name:"MiawShoes Pro", logo:"assets/img/seller.jpg"} },
  "whisker-glide": { id:"whisker-glide", name:"Whisker Glide", price:649000, images:["assets/img/shoe7.jpg","assets/img/shoe7-2.jpg","assets/img/shoe7-3.jpg"], description:"Glide mudah, nyaman dipakai setiap hari.", fullDescription:"Whisker Glide kombinasi cushioning dan desain ramping untuk kenyamanan gaya urban.", rating:4.4, reviews:[{user:"Luna", rating:4, text:"Stylish & nyaman, recommended."},{user:"Budi", rating:4, text:"Harga pas untuk kualitas ini."}], seller:{name:"MiawShoes Urban", logo:"assets/img/seller.jpg"} },
  "furrunner": { id:"furrunner", name:"FurRunner", price:729000, images:["assets/img/shoe8.jpg","assets/img/shoe8-2.jpg","assets/img/shoe8-3.jpg"], description:"Performa yang tetap terlihat lucu.", fullDescription:"FurRunner dirancang untuk kenyamanan jalan jauh, sol empuk dengan tampilan fun.", rating:4.3, reviews:[{user:"Gilang", rating:4, text:"Cocok buat jalan-jalan jauh."},{user:"Rina", rating:4, text:"Nyaman tapi agak berat."}], seller:{name:"MiawShoes Casual", logo:"assets/img/seller.jpg"} },
  "meowstride": { id:"meowstride", name:"MeowStride", price:599000, images:["assets/img/shoe9.jpg","assets/img/shoe9-2.jpg","assets/img/shoe9-3.jpg"], description:"Step dengan gaya, nyaman setiap langkah.", fullDescription:"MeowStride cocok untuk yang ingin tampil beda tapi tetap nyaman sepanjang hari.", rating:4.6, reviews:[{user:"Indra", rating:5, text:"Banyak yang tanya beli darimana!"},{user:"Vina", rating:4, text:"Stylish dan cocok untuk anak muda."}], seller:{name:"MiawShoes Youth", logo:"assets/img/seller.jpg"} }
};

/* ---------------- UTIL ---------------- */
function formatRp(num){
  if(!num && num !== 0) return "Rp 0";
  return 'Rp ' + Number(num).toLocaleString('id-ID');
}

/* Get product id from query string */
const urlParams = new URLSearchParams(window.location.search);
const productId = urlParams.get('product') || 'catstep-classic';
const product = products[productId] || Object.values(products)[0];

/* Sizes available */
const SIZES = ["36","37","38","39","40","41","42"];

/* Render product detail */
const container = document.getElementById('product-detail');
function renderProduct(p){
  container.innerHTML = `
    <div class="col-lg-6">
      <div class="product-images">
        <img id="main-img" src="${p.images[0]}" alt="${p.name}">
        <div class="thumbnail-list mt-3" id="thumbs">
          ${p.images.map((img,i)=>`<img src="${img}" data-src="${img}" class="${i===0?'active':''}" alt="thumb-${i}">`).join('')}
        </div>
      </div>
    </div>

    <div class="col-lg-6">
      <div class="product-name">${p.name}</div>
      <div class="product-price">${formatRp(p.price)}</div>
      <div class="product-description">${p.description}</div>

      <div style="margin-bottom:10px;">
        <div style="font-weight:700;margin-bottom:6px;">Pilih Ukuran:</div>
        <div id="size-options" style="display:flex;gap:8px;flex-wrap:wrap;">
          ${SIZES.map(s=>`<label style="cursor:pointer"><input type="radio" name="size" value="${s}" style="margin-right:6px"> ${s}</label>`).join('')}
        </div>
      </div>

      <div class="quantity-control" aria-hidden="true">
        <button id="decrease">-</button>
        <input type="number" id="quantity" value="1" min="1" />
        <button id="increase">+</button>
      </div>

      <div class="mb-3">
        <a href="#" id="add-cart" class="btn-cart me-2">Add to Cart</a>
        <a href="#" id="buy-now" class="btn-buy">Buy Now</a>
      </div>

      <ul class="nav nav-tabs mt-3" id="detailTab" role="tablist">
        <li class="nav-item" role="presentation">
          <button class="nav-link active" id="desc-tab" data-bs-toggle="tab" data-bs-target="#desc">Description</button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="review-tab" data-bs-toggle="tab" data-bs-target="#review">Reviews (${p.reviews.length})</button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="seller-tab" data-bs-toggle="tab" data-bs-target="#seller">Seller</button>
        </li>
      </ul>

      <div class="tab-content p-3" style="background:#fff;border-radius:12px;margin-top:10px;">
        <div class="tab-pane fade show active" id="desc">${p.fullDescription}</div>
        <div class="tab-pane fade" id="review">
          <p><strong>Rating:</strong> <span class="star">${'â˜…'.repeat(Math.floor(p.rating))}</span> (${p.rating})</p>
          ${p.reviews.map(r=>`<div class="review-box"><strong>${r.user}</strong> <span class="star">${'â˜…'.repeat(Math.round(r.rating))}</span><p style="margin:6px 0 0">${r.text}</p></div>`).join('')}
        </div>
        <div class="tab-pane fade" id="seller">
          <div class="seller-box">
            <img src="${p.seller.logo}" alt="${p.seller.name}" class="seller-logo">
            <div>
              <div style="font-weight:800;color:var(--accent);">${p.seller.name}</div>
              <div class="small text-muted">Official seller â€¢ Pengiriman cepat â€¢ Garansi kualitas</div>
            </div>
          </div>
        </div>
      </div>

    </div>
  `;
  attachGalleryListeners();
  attachQuantityListeners();
  attachCartButtons();
}

function attachGalleryListeners(){
  const mainImg = document.getElementById('main-img');
  document.querySelectorAll('.thumbnail-list img').forEach(img=>{
    img.addEventListener('click', function(){
      document.querySelectorAll('.thumbnail-list img').forEach(t=>t.classList.remove('active'));
      this.classList.add('active');
      mainImg.src = this.getAttribute('data-src');
    });
  });
}
function attachQuantityListeners(){
  const qty = document.getElementById('quantity');
  document.getElementById('increase').addEventListener('click',()=>{ qty.value = Number(qty.value) + 1; });
  document.getElementById('decrease').addEventListener('click',()=>{ if(Number(qty.value) > 1) qty.value = Number(qty.value) - 1; });
}

/* ---------------- CART (localStorage key: 'cart') ---------------- */
function getCart(){ return JSON.parse(localStorage.getItem('cart')) || []; }
function saveCart(c){ localStorage.setItem('cart', JSON.stringify(c)); updateCartUI(); }

function updateCartUI(){
  const cart = getCart();
  const countEl = document.getElementById('cart-count');
  countEl.innerText = cart.reduce((s,i)=>s + Number(i.quantity), 0);

  const cartItemsEl = document.getElementById('cart-items');
  cartItemsEl.innerHTML = '';
  let total = 0;
  if(cart.length === 0){
    cartItemsEl.innerHTML = '<p style="text-align:center;color:#666;margin:10px 0;">Keranjang kosong ðŸ˜¿</p>';
  } else {
    cart.forEach((item, idx) => {
      const itemTotal = item.price * item.quantity;
      total += itemTotal;
      const div = document.createElement('div');
      div.className = 'cart-item';
      div.innerHTML = `
        <img src="${item.image}" alt="${item.name}">
        <div class="meta">
          <div class="name">${item.name}</div>
          <div class="small">${formatRp(item.price)} Ã— ${item.quantity}</div>
          <div class="small" style="margin-top:6px">Ukuran:
            <select class="cart-size" data-idx="${idx}">
              ${SIZES.map(s=>`<option value="${s}" ${s===String(item.size)?'selected':''}>${s}</option>`).join('')}
            </select>
          </div>
        </div>
        <div style="text-align:right;">
          <div style="font-weight:800">${formatRp(itemTotal)}</div>
          <div class="cart-controls">
            <button class="btn-decrease" data-idx="${idx}">-</button>
            <div style="min-width:22px;text-align:center">${item.quantity}</div>
            <button class="btn-increase" data-idx="${idx}">+</button>
            <div style="margin-top:6px"><a href="#" class="remove-item small text-danger" data-idx="${idx}">Hapus</a></div>
          </div>
        </div>
      `;
      cartItemsEl.appendChild(div);
    });
  }
  document.getElementById('cart-popup-total').innerText = formatRp(total);

  // events
  document.querySelectorAll('.remove-item').forEach(el=>{
    el.addEventListener('click', e=>{
      e.preventDefault();
      const idx = Number(el.getAttribute('data-idx'));
      const c = getCart();
      c.splice(idx,1);
      saveCart(c);
    });
  });
  document.querySelectorAll('.btn-increase').forEach(el=>{
    el.addEventListener('click', ()=>{
      const idx = Number(el.getAttribute('data-idx'));
      const c = getCart();
      c[idx].quantity = Number(c[idx].quantity) + 1;
      saveCart(c);
    });
  });
  document.querySelectorAll('.btn-decrease').forEach(el=>{
    el.addEventListener('click', ()=>{
      const idx = Number(el.getAttribute('data-idx'));
      const c = getCart();
      if(c[idx].quantity > 1) c[idx].quantity = Number(c[idx].quantity) - 1;
      else c.splice(idx,1);
      saveCart(c);
    });
  });
  document.querySelectorAll('.cart-size').forEach(sel=>{
    sel.addEventListener('change', ()=>{
      const idx = Number(sel.getAttribute('data-idx'));
      const c = getCart();
      c[idx].size = sel.value;
      saveCart(c);
    });
  });
}

/* --------------- Add to Cart & Buy Now --------------- */
function getSelectedSize(){
  const sel = document.querySelector('input[name="size"]:checked');
  return sel ? sel.value : null;
}

function saveAndGoToCheckout(){
  const qty = Number(document.getElementById('quantity').value) || 1;
  const size = getSelectedSize();
  if(!size){
    alert('Pilih ukuran sepatu terlebih dahulu (36â€“42).');
    return;
  }
  const cart = getCart();
  const existing = cart.find(i => i.id === product.id && String(i.size) === String(size));
  if(existing){
    existing.quantity = Number(existing.quantity) + qty;
  } else {
    cart.push({
      id: product.id,
      name: product.name,
      price: product.price,
      image: product.images[0],
      quantity: qty,
      size: size
    });
  }
  saveCart(cart);
  window.location.href = 'checkout.html';
}

function attachCartButtons(){
  const addBtn = document.getElementById('add-cart');
  const buyBtn = document.getElementById('buy-now');

  addBtn.addEventListener('click', e=>{
    e.preventDefault();
    saveAndGoToCheckout();
  });
  buyBtn.addEventListener('click', e=>{
    e.preventDefault();
    saveAndGoToCheckout();
  });
}

/* ------------- Mini cart toggle ------------- */
const cartIcon = document.getElementById('cart-icon');
const cartPopup = document.getElementById('cart-popup');
cartIcon.addEventListener('click', (e)=>{
  e.stopPropagation();
  cartPopup.classList.toggle('visible');
});
document.addEventListener('click', (e)=>{
  if(!document.getElementById('cart-container').contains(e.target)){
    cartPopup.classList.remove('visible');
  }
});

/* ------------- INIT ------------- */
renderProduct(product);
updateCartUI();
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>